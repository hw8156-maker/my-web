<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í˜œì›ì˜ MQTT í˜ì´ì§€</title>
</head>
<body>

    <h1>ë‚´ ì›¹í˜ì´ì§€</h1>
    <p>ì•„ë˜ëŠ” MQTT ë©”ì‹œì§€ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ì˜ì—­ì…ë‹ˆë‹¤.</p>

    <div style="margin-top:30px; padding:20px; background:#f0f0f0; border-radius:10px;">
        <h2>ğŸ“¡ MQTT ë©”ì‹œì§€</h2>
        <div id="mqtt-box" style="font-size:20px; color:#333; font-weight:bold;">
            (ë©”ì‹œì§€ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...)
        </div>
    </div>

    <!-- âœ” ë¸Œë¼ìš°ì €ìš© MQTT WebSocket Client -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js"></script>

    <script>
        console.log("ğŸš€ Paho MQTT library loaded:", typeof Paho);

        const clientID = "webclient_" + Math.random().toString(16).substr(2, 8);

        // WebSocket ì£¼ì†Œ (ì´ê±´ ë‚˜ì¤‘ì— ë§ì¶°ì¤„ê²Œ!)
        const client = new Paho.MQTT.Client("wss://damoa.io:8084/", clientID);

        client.onConnectionLost = function(responseObject) {
            console.log("MQTT Connection Lost:", responseObject.errorMessage);
        };

        client.onMessageArrived = function(message) {
            console.log("MQTT Message Arrived:", message.payloadString);
            document.getElementById("mqtt-box").innerText = message.payloadString;
        };

        client.connect({
            onSuccess: function() {
                console.log("MQTT Connected!");
                client.subscribe("ewha/2270095");
            },
            useSSL: true
        });
    </script>

</body>
</html>




